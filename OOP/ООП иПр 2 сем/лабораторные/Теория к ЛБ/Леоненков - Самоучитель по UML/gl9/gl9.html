<HTML>
<HEAD>
   <meta http-equiv="Content-Type" content="text/html; WINDOWS-1251">
   <meta name="Author" content="Leonenkov">
   <meta name="Generator" content="Aditor">
   <meta name="Description" content="UML Teach Yourself">
   <meta name="Owner" content="lesly@mipk-kspu.kharkov.ua">
   <meta name="Keywords" content="Леоненков, самоучитель UML, UML">

<TITLE> Леоненков. Самоучитель UML.</TITLE>
<!--                                                                   -->
<!-- (C) Owner: Oleg G. Starusev  -->
<!-- (C) НТУ "ХПИ". Каф.Информатики и интеллектуальной собственности, 2003. -->

</HEAD>

<BODY background=../iip_1.jpg>
<p><a href=../index.htm>Каталог</a></p>
<hr>

<p><CENTER><font size="4"><b>ГЛАВА 9 <br>Диаграмма кооперации (collaboration diagram)</b></font></center>
</P>
<br>
<br>

<ul>
  <li><a href="gl9.html#1">9.1. Кооперация</a><ul>
  <li><a href="gl9.html#2">Диаграмма кооперации уровня спецификации </a></ul>
  <li><a href="gl9.html#3">9.2. Объекты</a><ul>
  <li><a href="gl9.html#4">Мультиобъект</a>
  <li><a href="gl9.html#5">Активный объект</a>
  <li><a href="gl9.html#6">Составной объект</a></ul>
  <li><a href="gl9.html#7">9.3. Связи</a><ul>
  <li><a href="gl9.html#8">Стереотипы связей </a></ul>
  <li><a href="gl9.html#9">9.4. Сообщения</a><ul>
  <li><a href="gl9.html#10">Формат записи сообщений</a></ul>
  <li><a href="gl9.html#11">9.5. Пример построения диаграммы кооперации</a>
  <li><a href="gl9.html#12">9.6. Заключительные рекомендации по построению диаграмм кооперации </a>
</UL>


<P>
Как отмечалось в предыдущей главе, особенности взаимодействия элементов моделируемой системы могут быть представлены на диаграммах последовательности и кооперации. Если первая служит для визуализации временных аспектов взаимодействия, то диаграмма кооперации предназначена для спецификации структурных аспектов взаимодействия. Главная особенность диаграммы кооперации заключается в возможности графически представить не только последовательность взаимодействия, но и все структурные отношения между объектами, участвующими в этом взаимодействии.
</P>
<P>
Прежде всего, на диаграмме кооперации в виде прямоугольников изображаются участвующие во взаимодействии объекты, содержащие имя объекта, его класс и, возможно, значения атрибутов. Далее, как и на диаграмме классов, указываются ассоциации между объектами в виде различных соединительных линий. При этом можно явно указать имена ассоциации и ролей, которые играют объекты в данной ассоциации. Дополнительно могут быть изображены динамические связи — потоки сообщений. Они представляются также в виде соединительных линий между объектами, над которыми располагается стрелка с указанием направления, имени сообщения и порядкового номера в общей последовательности инициализации сообщений.
</P>
<P>
В отличие от диаграммы последовательности, на диаграмме кооперации изображаются только отношения между объектами, играющими определенные роли во взаимодействии. С другой стороны, на этой диаграмме не указывается время в виде отдельного измерения. Поэтому последовательность взаимодействий и параллельных потоков может быть определена с помощью порядковых номеров. Следовательно, если необходимо явно специфицировать взаимосвязи между объектами в реальном времени, лучше это делать на диаграмме последовательности.
</P>
<P>
Поведение системы может описываться на уровне отдельных объектов, которые обмениваются между собой сообщениями, чтобы достичь нужной цели или реализовать некоторый сервис. С точки зрения аналитика или конструктора важно представить в проекте системы структурные связи отдельных объектов между собой. Такое статическое представление структуры системы как совокупности взаимодействующих объектов и обеспечивает диаграмма кооперации.
</P>
<P>
Таким образом, с помощью диаграммы кооперации можно описать полный контекст взаимодействий как своеобразный временной &quot;среза&quot; совокупности объектов, взаимодействующих между собой для выполнения определенной задачи или бизнес-цели программной системы.
</P>

<p>&nbsp;
<a NAME="1"></a><font size="4">9.1. Кооперация</font>


<P>
Понятие кооперации (collaboration) является одним из фундаментальных понятий в языке UML. Оно служит для обозначения множества взаимодействующих с определенной целью объектов в общем контексте моделируемой системы. Цель самой кооперации состоит в том, чтобы специфицировать особенности реализации отдельных наиболее значимых операций в системе. Кооперация определяет структуру поведения системы в терминах взаимодействия участников этой кооперации.
</P>
<P>
Кооперация может быть представлена на двух уровнях:
</P>
<ul>
  <li>На уровне спецификации — показывает роли классификаторов и роли ассоциаций в рассматриваемом взаимодействии.</li>
  <li>На уровне примеров — указывает экземпляры и связи, образующие отдельные роли в кооперации.</li>
</ul>
<P>
Диаграмма кооперации уровня спецификации показывает роли, которые играют участвующие во взаимодействии элементы. Элементами кооперации на этом уровне являются классы и ассоциации, которые обозначают отдельные роли классификаторов и ассоциации между участниками кооперации.
</P>
<P>
Диаграмма кооперации уровня примеров представляется совокупностью объектов (экземпляры классов) и связей (экземпляры ассоциаций). При этом связи дополняются стрелками сообщений. На данном уровне показываются только релевантные объекты, т. е. имеющие непосредственное отношение к реализации операции или классификатора.
</P>
<P>
В кооперации уровня примеров определяются свойства, которые должны иметь экземпляры для того, чтобы участвовать в кооперации. Кроме свойств объектов на диаграмме кооперации также указываются ассоциации, которые должны иметь место между объектами кооперации. При этом вовсе не обязательно изображать все свойства или все ассоциации, поскольку на диаграмме кооперации присутствуют только роли классификаторов, но не сами классификаторы. Таким образом, в то время как классификатор требует полного описания всех своих экземпляров, роль классификатора требует
описания только тех свойств и ассоциаций, которые необходимы для участия в отдельной кооперации.
</P>
<P>
Отсюда вытекает важное следствие. Одна и та же совокупность объектов может участвовать в различных кооперациях. При этом, в зависимости от рассматриваемой кооперации, могут изменяться как свойства отдельных объектов, так и связи между ними. Именно это отличает диаграмму кооперации от диаграммы классов, на которой должны быть указаны все свойства и ассоциации между элементами диаграммы.
</P>
<p>&nbsp;
<a NAME="2"></a><font size="4">
Диаграмма кооперации уровня спецификации</font>
</P>
<P>
Кооперация на уровне спецификации изображается на диаграмме пунктирным эллипсом, внутри которого записывается имя этой кооперации (рис. 9.1). Такое представление кооперации относится к отдельному варианту использования и детализирует особенности его последующей реализации. Символ эллипса кооперации соединяется отрезками пунктирной линии с каждым из участников этой кооперации, в качестве которых могут выступать объекты или классы. Каждая из этих пунктирных линий помечается ролью (role) участника. Роли соответствуют именам элементов в контексте всей кооперации. Эти имена трактуются как параметры, которые ограничивают спецификацию элементов при любом их появлении в отдельных представлениях модели.
</P>
<IMG src="gl9-1.jpg">
<P><b>
Рис. 9.1.</b> Общее представление кооперации на диаграммах
уровня спецификации
</P>
<P>
Простой класс на диаграмме кооперации обозначается прямоугольником класса, внутри которого записывается строка текста. Эта строка текста называется ролью классификатора (classifier role). Роль классификатора показывает особенность использования объектов данного класса. Обычно в прямоугольнике показывается только секция имени класса, хотя не исключается возможность указания секций атрибутов и операций.
</P>
<P>
Строка текста в прямоугольнике должна иметь следующий формат:
</P>
<P>
'/' &lt;Имя роли классификатора&gt; ':' &lt;Имя классификатора&gt;&nbsp;
</P>
<P>
 [':' &lt;Имя классификатора &gt;]*
</P>
<P>
Здесь Имя классификатора, если это необходимо, может включать полный путь всех вложенных пакетов. При этом один пакет от другого отделяется двойным двоеточием &quot;::&quot;. Если не возникает путаницы, можно ограничиться указанием только ближайшего из пакетов, которому принадлежит данная
кооперация. Символ &quot;*&quot; применяется для указания возможности итеративного повторения имени классификатора.
</P>
<P>
Если кооперация допускает обобщенное представление, то на диаграммах могут быть указаны отношения обобщения соответствующих элементов. Этот способ может быть использован для определения отдельных коопераций, которые являются, в свою очередь, частным случаем или специализацией другой кооперации. Такая ситуация изображается обычной стрелкой обобщения, направленной от символа дочерней кооперации к символу кооперации-предка (рис. 9.2). При этом роли дочерних коопераций могут быть специализациями ролей коопераций-предков.
</P>
<IMG src="gl9-2.jpg">
<P>
<b>
Рис. 9.2.</b> Графическое изображение отношения обобщения между отдельными кооперациями уровня спецификации
</P>
<P>
В отдельных случаях возникает необходимость явно указать тот факт, что кооперация является реализацией некоторой операции или классификатора. Это можно представить одним из двух способов.
</P>
<P>
Во-первых, можно соединить символ кооперации пунктирной линией со стрелкой обобщения с символом класса, реализацию операции которого специфицирует данная кооперация (рис. 9.3, а). Так, если в качестве класса рассмотреть &quot;Заказ на покупку товара&quot;, у которого имеется операция &quot;оформить_заказ (), то ее реализация может быть специфицирована в форме кооперации.
</P>
<IMG src="gl9-3.jpg">
<P>
<b>
Рис. 9.3.</b> Способы представления кооперации, которая реализует операцию класса
</P>
<P>
Во-вторых, можно просто изобразить символ кооперации, внутри которого указать всю необходимую информацию, записанную по определенным правилам (рис. 9.3, б). Эти правила определяют формат записи имени кооперации, после которого записывают двоеточие и имя класса. За именем класса следует двойное двоеточие и имя операции.
</P>
<P>
Подобное общее представление кооперации на уровне спецификации используется на начальных этапах проектирования. В последующем каждая из коопераций подлежит детализации на уровне примеров, на котором раскрывается содержание и структура взаимосвязей ее элементов на отдельной диаграмме кооперации. При этом в качестве элементов диаграммы кооперации выступают объекты и связи, дополненные сообщениями. Именно эти элементы являются предметом дальнейшего рассмотрения в настоящей главе.
</P>
<p>&nbsp;
<a NAME="3"></a><font size="4">
9.2. Объекты</font>
</P>
<P>
Отдельные аспекты спецификации объектов как элементов диаграмм уже рассматривались ранее при описании диаграмм классов (см. главу 5) и последовательности (см. главу 8). Сейчас мы более подробно остановимся на особенностях их семантики и графической нотации, поскольку объекты являются основными элементами или графическими примитивами, из которых строится диаграмма кооперации на уровне примеров. Для графического изображения объектов используется такой же символ прямоугольника, что и для классов.
</P>
<P>
Как отмечалось выше, объект (object) является отдельным экземпляром класса, который создается на этапе выполнения программы. Он может иметь свое собственное имя и конкретные значения атрибутов. Применительно к объектам формат строки классификатора дополняется именем объекта и приобретает следующий вид (при этом вся запись подчеркивается):
</P>
<P>
&lt;Имя объекта&gt;'/' &lt;Имя роли классификатора&gt; ':' &lt;Имя классификатора&gt;&nbsp;
</P>
<P>
 [':' &lt;Имя классификатора &gt;]*
</P>
<P>
Здесь Имя роли классификатора может не указываться. В этом случае оно исключается из строки текста вместе с последующим двоеточием. Имя роли может быть опущено в том случае, если существует только одна роль в кооперации, которую могут играть объекты, созданные на базе этого класса.
</P>
<P>
Таким образом, для обозначения роли классификатора достаточно указать либо имя класса (вместе с двоеточием), либо имя роли (вместе с наклонной чертой). В противном случае прямоугольник будет соответствовать обычному классу. Если роль, которую должен играть объект, наследуется от нескольких классов, то все они должны быть указаны явно и разделяться запятой и двоеточием.
</P>
<P>
<U><b><font color="#006600">Примечание</font></b></U>
</P>
<P>
<font color="#006600">
В прямоугольнике объекта имя объекта, имя роли с символом Т или имя класса могут отсутствовать. Однако двоеточие всегда должно стоять перед именем
класса, а косая черточка — перед именем роли. Следует еще раз акцентировать внимание на том обстоятельстве, что применительно к объектам вся запись должна быть подчеркнута, а имя объекта должно быть записано со строчной буквы.</font>
</P>
<P>
Ниже приводятся возможные варианты записи строки текста в прямоугольнике объекта.
</P>
<ul>
  <li>: С — анонимный объект, образуемый на основе класса С.&nbsp;</li>
  <li> <U>/ R</U> — анонимный объект, играющий роль
    R.</li>
  <li> <U>/ R : С</U> — анонимный объект, образуемый на основе класса С и играющий роль
    R.</li>
  <li> <U>О / R</U> — объект с именем О, играющий роль
    R.</li>
  <li> <U>О : С</U> — объект с именем О, образуемый на основе класса С.</li>
  <li> <U>О / R : С</U> — объект с именем О, образуемый на основе класса С и играющий роль
    R.</li>
  <li>О или — объект с именем О.</li>
  <li> <U>О :</U> — &quot;объект-сирота&quot; с именем О.</li>
  <li>/ R — роль с именем R</li>
  <li>: С — анонимная роль на базе класса С.</li>
  <li>/ R : С — роль с именем R на основе класса С.</li>
</ul>
<P>
Отдельные примеры изображения объектов и классов на диаграмме кооперации приводятся на следующем рисунке (рис. 9.4).
</P>
<IMG src="gl9-4.jpg">
<P>
<b>
Рис. 9.4.</b> Примеры различных вариантов записи имен объектов, ролей и классов на диаграммах кооперации
</P>
<P>
Так, в первом случае (рис. 9.4, а) обозначен объект с именем &quot;клиент&quot;, играющий роль &quot;инициатор запроса&quot;. Далее (рис. 9.4, б) следует обозначение анонимного объекта, который играет роль инициатора запроса. В обоих случаях не указан класс, на основе которого будут созданы эти объекты. Обозначение класса присутствует в следующем варианте записи (рис. 9.4, в), причем объект также анонимный.
</P>
<P>
Применительно к уровню спецификации на диаграммах кооперации могут присутствовать именованные классы с указанием роли класса в кооперации (рис. 9.4, г) или анонимные классы, когда указывается только его роль (рис. 9.4, д). Последний случай характерен для ситуации, когда в модели могут присутствовать несколько классов с именем &quot;Клиент&quot;, поэтому требуется явно указать имя соответствующего пакета База данных (рис. 9.4, е).
</P>
<p>&nbsp;
<a NAME="4"></a><font size="4">
Мультиобъект</font>
</P>
<P>
Мультиобъект (multiobject) представляет собой целое множество объектов на одном из концов ассоциации. На диаграмме кооперации Мультиобъект используется для того, чтобы показать операции и сигналы, которые адресованы всему множеству объектов, а не только одному. Мультиобъект изображается двумя прямоугольниками, один из которых выступает из-за верхней правой вершины другого (рис. 9.5, а). При этом стрелка сообщения относится ко всему множеству объектов, которые обозначают данный мульти-объект. На диаграмме кооперации может быть явно указано отношение композиции между мультиобъектом и отдельным объектом из его множества (рис. 9.5, б).
</P>
<IMG src="gl9-5.jpg">
<P>
<b>
Рис. 9.5. </b> Графическое изображение мультиобъектов на диаграмме кооперации
</P>
<p>&nbsp;
<a NAME="5"></a><font size="4">
Активный объект</font>
</P>
<P>
В контексте языка UML все объекты делятся на две категории: пассивные и активные. Пассивный объект оперирует только данными и не может инициировать деятельность по управлению другими объектами. Однако пассивные объекты могут посылать сигналы в процессе выполнения запросов, которые они получают.
</P>
<P>
Активный объект (active object) имеет свою собственную нить (thread) управления и может инициировать деятельность по управлению другими объектами. При этом под нитью понимается некоторый облегченный поток управления, который может выполняться параллельно с другими вычислительными нитями или нитями управления в пределах одного вычислительного процесса или процесса управления.
</P>
<P>
<U><b><font color="#006600">Примечание</font></b></U>
</P>
<P>
<font color="#006600">
Отличие между процессом и нитью заключается в степени использования ресурсов. Говоря о процессе, имеют в виду ресурсоемкий поток управления, т. е. процесс полностью монополизирует ресурсы системы. Нить может использовать лишь небольшую часть ресурсов системы. Примером может служить выполнение некоторой программы в своем адресном пространстве или в фоновом режиме.</font>
</P>
<P>
Активные объекты на канонических диаграммах обозначаются прямоугольником с более широкими границами (рис. 9.6). Иногда может быть явно указано ключевое слово (помеченное значение) {active}, чтобы выделить активный объект на диаграмме. Каждый активный объект может инициировать единственную нить или процесс управления и представлять исходную точку потока управления. В приведенном фрагменте диаграммы кооперации активный объект &quot;а: Вызывающий абонент&quot; является инициатором процесса установления соединения для обмена информацией с другим абонентом (на диаграмме не показан).
</P>
<IMG src="gl9-6.jpg">
<P>
<b>
Рис. 9.6.</b> Графическое изображение активного объекта (слева) на диаграмме кооперации
</P>
<P>
В следующем примере рассматривается ситуация с вызовом функции печати из текстового редактора (рис. 9.7). Анонимный активный объект &quot;Текстовый редактор&quot; вначале посылает сообщение анонимному мультиобъекту &quot;Принтер&quot;, которое инициирует выбор единственного объекта &quot;Принтер&quot;, возможно, удовлетворяющего некоторым дополнительным условиям. После этого выбранному объекту посылается сообщение о необходимости напечатать документ, загруженный в текстовый редактор.
</P>
<IMG src="gl9-7.jpg">
<P>
<b>
Рис. 9.7. </b> Фрагмент диаграммы кооперации для вызова функции печати из текстового редактора
</P>
<p>&nbsp;
<a NAME="6"></a><font size="4">
Составной объект</font>
</P>
<P>
Составной объект (composite object) или объект-контейнер предназначен для представления объекта, имеющего собственную структуру и внутренние потоки (нити) управления. Составной объект является экземпляром составного
класса (класса-контейнера), который связан отношением агрегации или композиции (см. главу 5) со своими частями. Аналогичные отношения связывают между собой и соответствующие объекты.
</P>
<P>
На диаграммах кооперации такой составной объект изображается как обычный объект, состоящий из двух секций: верхней и нижней. В верхней секции записывается имя составного объекта, а в нижней — его составные части вместо списка его атрибутов (рис. 9.8). При этом допускается иметь в качестве частей другие составные объекты.
</P>
<IMG src="gl9-8.jpg">
<P>
<b>
Рис. 9.8.</b> Графическое изображение составного объекта на диаграмме кооперации
</P>
<p>&nbsp;
<a NAME="7"></a><font size="4">
9.3. Связи</font>
</P>
<P>
Связь (link) является экземпляром или примером произвольной ассоциации. Связь как элемент языка UML может иметь место между двумя и более объектами. Бинарная связь на диаграмме кооперации изображается отрезком прямой линии, соединяющей два прямоугольника объектов (см. рис. 9.7). На каждом из концов этой линии могут быть явно указаны имена ролей данной ассоциации. Рядом с линией в ее средней части может записываться имя соответствующей ассоциации.
</P>
<P>
Связи не имеют собственных имен, поскольку полностью идентичны как экземпляры ассоциации. Другими словами, все связи на диаграмме кооперации могут быть только анонимными и записываются без двоеточия перед-именем ассоциации. Для связей не указывается также и кратность. Однако другие обозначения специальных случаев ассоциации (агрегация, композиция) могут присутствовать на отдельных концах связей. Например, символ связи типа &quot;композиция&quot; между мультиобъектом &quot;Принтер&quot; и отдельным объектом &quot;Принтер&quot; (см. рис. 9.7).
</P>
<p>&nbsp;
<a NAME="8"></a><font size="4">
Стереотипы связей</font>
</P>
<P>
Связь может иметь некоторые стереотипы, которые записываются рядом с одним из ее концов и указывают на особенность реализации данной связи. В языке UML для этой цели могут использоваться следующие стереотипы:
</P>
<ul>
  <li>&quot;association&quot; — ассоциация (предполагается по умолчанию, поэтому этот стереотип можно не указывать).</li>
  <li>&quot;parameter&quot; —  параметр  метода.  Соответствующий  объект может быть<SUP>ч </SUP>только параметром некоторого метода.</li>
  <li>&quot;local&quot; — локальная переменная метода. Ее область видимости ограничена только соседним объектом.</li>
  <li>&quot;global&quot; — глобальная переменная. Ее область видимости распространяется на всю диаграмму кооперации.</li>
  <li>&quot;self — рефлексивная связь объекта с самим собой, которая допускает передачу объектом сообщения самому себе. На диаграмме кооперации рефлексивная связь изображается петлей в верхней части прямоугольника объекта.</li>
</ul>
<P>
Некоторые примеры связей с различными стереотипами изображены на рис. 9.9. Здесь представлена обобщенная схема некоторой конкретной компании с именем &quot;С&quot;, которая состоит из отделов (анонимный мультиобъект &quot;Отдел&quot;). Последние, в свою очередь, состоят из сотрудников (анонимный мультиобъект &quot;Сотрудник&quot;). Рефлексивная связь указывает на тот факт, что менеджер отдела является в то же время и его сотрудником.
</P>
<IMG src="gl9-9.jpg">
<P>
<b>
Рис. 9.9.</b> Графическое изображение связей с различными стереотипами
</P>
<p>
<U><b><font color="#006600">Примечание</font></b></U></p>
<P>
<font color="#006600">
Поскольку на данной диаграмме отсутствуют сообщения, то она не является, строго говоря, диаграммой кооперации. Скорее это специальный случай диаграммы классов, который иногда называют диаграммой объектов. В случае N-арной связи эта связь изображается аналогично N-арной ассоциации с использованием символа ромба.</font>
</P>
<p>&nbsp;
<a NAME="9"></a><font size="4">
9.4. Сообщения</font>
</P>
<P>
Сообщения, как элементы языка LJML, уже рассматривались ранее при изучении диаграммы последовательности (см. главу 8). При построении диаграммы кооперации они имеют некоторые дополнительные семантические
особенности. Сообщение на диаграмме кооперации специфицирует коммуникацию между двумя объектами, один из которых передает другому некоторую информацию. При этом первый объект ожидает, что после получения сообщения вторым объектом последует выполнение некоторого действия. Таким образом, именно сообщение является причиной или стимулом для начала выполнения операций, отправки сигналов, создания и уничтожения отдельных объектов. Связь обеспечивает канал для направленной передачи сообщений между объектами от объекта-источника к объекту-получателю.
</P>
<IMG src="gl9-10.jpg">
<P>
<b>
Рис. 9.10.</b> Графическое изображение различных типов сообщений на диаграмме кооперации
</P>
<P>
Сообщения в языке UML также специфицируют роли, которые играют объекты — отправитель и получатель сообщения. Сообщения на диаграмме кооперации изображаются помеченными стрелками рядом (выше или ниже) с соответствующей связью или ролью ассоциации. Направление стрелки указывает на получателя сообщения. Внешний вид стрелки сообщения имеет определенный смысл. На диаграммах кооперации может использоваться один из четырех типов стрелок для обозначения сообщений (рис. 9.10):
</P>
<ol>
  <li>Сплошная линия с треугольной стрелкой (рис. 9.10, а) обозначает вызов процедуры или другого вложенного потока управления. Может быть также использована совместно с параллельно активными объектами, когда один из них передает сигнал и ожидает, пока не закончится некоторая вложенная последовательность действий. Обычно все такие сообщения являются синхронными, т. е. инициируемыми по завершении некоторой деятельности или при выполнении некоторого условия.</li>
  <li>Сплошная линия с V-образной стрелкой (рис. 9.10, б) обозначает простой поток управления. Каждая такая стрелка изображает один этап в последовательности потока управления. Обычно все такие сообщения являются асинхронными.</li>
  <li>Сплошная линия с полустрелкой (рис. 9.10, в) используется для обозначения асинхронного потока управления. Соответствующие сообщения формируются в произвольные, заранее не известные моменты времени, как правило, активными объектами. Обычно сообщения этого типа являются начальными в последовательности потока управления и чаще всего инициируются актерами.</li>
  <li>Пунктирная линия с V-образной стрелкой (рис. 9.10, г) обозначает возврат из вызова процедуры. Стрелки этого типа зачастую отсутствуют на диаграммах кооперации, поскольку неявно предполагается их существование после окончания процесса активизации некоторой деятельности.</li>
</ol>
<p>&nbsp;
<a NAME="10"></a><font size="4">
Формат записи сообщений</font>
</P>
<P>
Каждое сообщение может быть помечено строкой текста, которая имеет следующий формат:
</P>
<P>
&lt; Предшествующие сообщения&gt; &lt; [Сторожевое условие] &gt;
</P>
<P>
&lt;Выражение последовательности&gt;
</P>
<P>
&lt;Возвращаемое значение— имя сообщения&gt; &lt;Список аргументов&gt;
</P>
<P>
Рассмотрим каждый из этих элементов более подробно.
</P>
<ul>
  <li>Предшествующие сообщения — есть разделенные запятыми номера сообщений, записанные перед наклонной черточкой:</li>
</ul>
<blockquote>
<P align="left">
&lt;Номер сообщения ','&gt;&lt; Номер сообщения,'&gt; '/'
</P>
<P>
Если список номеров сообщений пуст, то вся запись, включая наклонную черточку (слэш), опускается. Каждый номер сообщения может быть выражением последовательности без рекурсивных символов. Выражение должно определять номер другого сообщения в этой же последовательности.
</P>
</blockquote>
<P>
<U><b><font color="#006600">Примечание</font></b></U>
</P>
<P>
<font color="#006600">
Заметим, что сами номера последовательности сообщений с одинаковым префиксом образуют отношение упорядоченности и, соответственно, неявно указывают на предшествующие сообщения. Таким предшествующим сообщением будет сообщение с номером, самая правая цифра которого на единицу меньше, чем у рассматриваемого сообщения. Например, сообщение с номером &quot;3.1.4.6&quot; имеет в качестве предшествующего сообщение с номером &quot;3.1.4.5&quot;.</font>
</P>
<blockquote>
<P>
Смысл указания предшествующих сообщений заключается в том, что данное сообщение не может быть передано, пока не будут переданы своим адресатам все сообщения, номера которых записаны в данном списке.
</P>
<P>
Пример записи предшествующих сообщений:&nbsp;
</P>
<P>
 A3, В4/ С5: ошибка записи (сектор).
</P>
</blockquote>
<ul>
  <li>Сторожевое условие является обычным булевским выражением и предназначено для синхронизации отдельных нитей потока управления. Записывается в квадратных скобках и может быть опущено, если оно отсутствует у данного сообщения. Семантика сторожевого условия обеспечивает передачу сообщения только в том случае, если это условие принимает значение &quot;истина&quot;.</li>
</ul>
<blockquote>
<P>
Пример записи сторожевых условий без номеров предшествующих сообщений:
</P>
  <ul>
    <li>[(х&gt;=0)&amp;(х&lt;=255)] 1.2: отобразить_на_экране_цвет(х)</li>
  </ul>
  <ul>
    <li>[количество цифр номера = 7] 3.1: набрать_телефонный_номер()</li>
  </ul>
</blockquote>
<ul>
  <li>Выражение последовательности — есть разделенный точками список отдельных термов последовательностей, после которого записывается двоеточие:</li>
</ul>
<blockquote>
  <P>
&lt;Терм последовательности'.'&gt;&lt;Терм последовательности'.'&gt;':'
</P>
<P>
Каждый из термов представляет отдельный уровень процедурной вложенности в форме законченной итерации. Наиболее верхний уровень соответствует самому левому терму последовательности. Если все потоки управления параллельные, то вложенность отсутствует. Каждый из термов последовательности имеет следующий синтаксис:
</P>
<P>
[Целое число| Имя] [Символ рекуррентности].
</P>
  <ul>
    <li>Целое число указывает на порядковый номер сообщения в процедурной последовательности верхнего уровня. Сообщения, номера которых отличаются на единицу, следуют подряд один за другим.</li>
  </ul>
  <blockquote>
<P>
Например, сообщение с номером &quot;3.1.4&quot; следует за сообщением с номером &quot;3.1.3&quot; в процедурной последовательности &quot;3.1&quot;.
</P>
  </blockquote>
  <ul>
    <li>Имя используется для спецификации параллельных нитей управления. Сообщения, которые отличаются только именем, являются параллельными на этом уровне вложенности. На одном уровне вложенности все нити управления эквивалентны в смысле приоритета передачи сообщений. С</li>
  </ul>
  <blockquote>
<P>
Например, сообщения с выражениями &quot;ЗЛа&quot; и &quot;3.16&quot; являются параллельными в процедурной последовательности &quot;3.1&quot;.
</P>
  </blockquote>
  <ul>
    <li>Символ рекуррентности используется для указания условного или итеративного выполнения. Семантика рекуррентности представляет ноль или больше сообщений, которые должны быть выполнены в зависимости от записанного условия. Возможны два случая записи рекуррентности:</li>
  </ul>
  <blockquote>
    <ol>
      <li>&nbsp;'*' '[' Предложение-итерация ']' для записи итеративного выполнения соответствующего выражения.</li>
    </ol>
<P>
Итерация представляет последовательность сообщений одного уровня вложенности. Предложение-итерация может быть опущено, если условия итерации никак не специфицируются. Наиболее часто предложение-итерация записывается на некотором псевдокоде или языке программирования. В языке UML формат записи этого предложения не определен. Например, &quot;*[/:=/..л]&quot;, что означает последовательную передачу сообщения с параметром /, который изменяется от 1 до некоторого целого числа п с шагом 1.
</P>
    <ol>
      <li value="2">'['Предложение-условие У для записи ветвления. Это условие представляет такое сообщение, передача которого по данной ветви возможна только при истинности этого условия. Чаще всего предложение-условие записывают на некотором псевдокоде или языке программирования, поскольку в языке UML формат записи этого предложения не определен. Например, [х&gt;у] означает, что сообщение по некоторой ветви будет передано только в том случае, если значение х больше значения у.</li>
    </ol>
  </blockquote>
</blockquote>
<p>
<U><b><font color="#006600">Примечание</font></b></U></p>
<P>
<font color="#006600">
Заметим, что условие записывается так же, как и итерация, но без звездочки. Это можно понимать как некоторую одношаговую итерацию. При этом предполагается, что итерация выполняется последовательно. Если необходимо отметить возможность параллельного выполнения итерации, в языке UML используется символ &quot;*||&quot;. Итерация не распространяется на вложенные уровни данного потока или нити. Каждый уровень должен иметь свое собственное представление для итеративного повторения процедурной последовательности.</font>
</P>
<ul>
  <li>Возвращаемое значение представляется в форме списка имен значений, возвращаемых по окончании коммуникации или взаимодействия в полной итерации данной процедурной последовательности. Эти идентификаторы могут выступать в качестве аргументов в последующих сообщениях. Если сообщение не
    возвращает никакого значения, то ни значение, ни оператор присваивания на диаграмме кооперации не указываются.</li>
</ul>
<blockquote>
<P>
Например, сообщение
</P>
  <p align="left">
1.2.3: р:= найти_документ (спецификация_документа)</p>
<P>
означает передачу вложенного сообщения с запросом поиска в базе данных нужного документа по его спецификации, причем источнику сообщения должен быть возвращен найденный документ.
</P>
</blockquote>
<ul>
  <li>Имя сообщения, записанное в сигнатуре после возвращаемого значения, означает имя события, которое инициируется объектом-получателем сообщения после его приема. Наиболее часто таким событием является вызов операции объекта. Это может быть реализовано различными способами, один из которых — вызов операции. Тогда соответствующая операция должна быть определена в том классе, которому принадлежит объект-получатель.</li>
  <li>Список аргументов представляет собой разделенные запятыми и заключенные в круглые скобки действительные параметры той операции, вызов которой инициируется данным сообщением. Список аргументов может быть пустым, однако скобки все равно записываются. Для записи аргументов также может быть использован некоторый псевдокод или язык программирования.</li>
</ul>
<blockquote>
<P>
Так, в приведенном выше примере сообщения
</P>
<P>
1.2.3: р:= найти_документ (спецификация_документа)
</P>
<P>
Аргумент найти_документ является именем сообщения, а специфика-ция_документа — списком аргументов, состоящим из единственного действительного параметра операции. При этом имя сообщения означает обращение к операции найти_ документ, которая должна быть определена в соответствующем классе объекта-получателя.
</P>
</blockquote>
<p>
<U><b><font color="#006600">Примечание</font></b></U></p>
<P>
<font color="#006600">
На диаграмме кооперации при записи сообщений также могут использоваться •  стереотипы, рассмотренные ранее при построении диаграммы последовательности (см. главу 8). Их семантика и синтаксис остаются без изменения, поскольку определены в нотации языка UML</font>
</P>
<p>&nbsp;
<a NAME="11"></a><font size="4">
9.5. Пример построения диаграммы кооперации</font>
</P>
<P>
В качестве примера рассмотрим построение диаграммы кооперации для моделирования процесса телефонного разговора с использованием обычной телефонной сети (см. главу ф. Напомним, что объектами в этом примере являются два абонента а и Ь, два телефонных аппарата с и &lt;/, коммутатор и сам разговор как объект моделирования. При этом как коммутатор, так и разговор являются анонимными объектами.
</P>
<P>
На начальном этапе изобразим все объекты и связи между ними на диаграмме кооперации при помощи соответствующих обозначений (рис. 9.11). Заметим, что первый телефонный аппарат изображен как активный объект, а второй — как пассивный.
</P>
<IMG src="gl9-11.jpg">
<P>
<b>
Рис. 9.11.</b> Начальный фрагмент диаграммы кооперации
для примера моделирования обычного телефонного разговора
</P>
<P>
В последующем необходимо специфицировать все связи на этой диаграмме, указав на их концах необходимую информацию в форме ролей связей. Дополненный таким образом вариант диаграммы кооперации изображен ниже (рис. 9.12). Заметим, что для объекта &quot;Разговор&quot; указано помеченное значение {transient}, которое означает, что этот объект создается в процессе выполнения объемлющего процесса и уничтожается до его завершения. Напомним, что помеченные значения (tagged values) являются стандартными элементами языка UML.
</P>
<IMG src="gl9-12.jpg">
<P>
<b>
Рис. 9.12.</b> фрагмент диаграммы кооперации, дополненный стереотипами ролей связей, именами ассоциаций и помеченным значением объекта
</P>
<IMG src="gl9-13.jpg">
<P>
<b>
Рис. 9.13.</b> Окончательный вариант диаграммы кооперации для моделирования телефонного разговора
</P>
<P>
Наконец, на диаграмму кооперации необходимо нанести все сообщения, указав их порядок и семантические особенности. Окончательный фрагмент диаграммы кооперации изображен на рис. 9.13 и содержит, строго говоря, модель кооперации только для начала разговора. Эта диаграмма может быть
дополнена сообщениями, необходимыми для окончания разговора, что читателям предлагается выполнить самостоятельно в качестве упражнения.
</P>
<P>
Как нетрудно заметить, диаграмма кооперации для примера с телефонным разговором не содержит ни временных особенностей передачи сообщений, ни особенностей жизненного цикла участвующих в данной кооперации объектов. Поэтому может быть принято решение о том, что она является избыточной при наличии построенной диаграммы последовательности. Этот факт не вызывает сомнений в тех случаях, когда структура взаимодействующих объектов является достаточно тривиальной.
</P>
<P>
Если же взаимодействующие объекты образуют между собой различные типы отношений-ассоциаций (композиция, агрегация), то диаграмма кооперации оказывается необходимым представлением модели на всех ее уровнях.
</P>
<p>&nbsp;
<a NAME="12"></a><font size="4">
9.6. Заключительные рекомендации по построению диаграмм кооперации</font>
</P>
<P>
Построение диаграммы кооперации можно начинать сразу после построения диаграммы вариантов использования. В этом случае каждый из вариантов использования может быть специфицирован в виде отдельной диаграммы кооперации уровня спецификации. Эта диаграмма способствует более . полному пониманию особенностей реализации функций системой, хотя и не может содержать всю информацию, необходимую для их реализации.
</P>
<P>
В дальнейшем, после построения диаграммы классов, каждая из диаграмм кооперации может уточняться в виде соответствующей диаграммы уровня примеров. Важно понимать, что диаграмма кооперации этого уровня может содержать те и только те объекты и связи, которые уже определены на построенной ранее диаграмме классов. В противном случае, если возникает необходимость включения в диаграмму кооперации объектов, которые создаются на основе отсутствующих классов, соответствующие диаграммы классов должны быть модифицированы явным описанием этих классов.
</P>
<P>
Следует помнить, что на диаграмме кооперации изображаются только те объекты, которые непосредственно в ней участвуют. При этом объекты могут выступать в различных ролях, которые должны быть явно указаны на соответствующих концах связей диаграммы. Применение стереотипов унифицирует кооперацию, обеспечивая ее адекватную интерпретацию как со стороны заказчиков, так и со стороны разработчиков. Тем не менее, целесообразно различать терминологию, используемую на диаграммах кооперации уровня спецификации и уровня примеров.
</P>
<P>
Так, при построении диаграмм кооперации уровня спецификации желательно применять наиболее понятную заказчику терминологию, избегая технических фраз и словосочетаний. Например, &quot;оформить заказ&quot;, &quot;отгрузить товар&quot;, &quot;представить отчет&quot;, &quot;разработать план&quot; и т. д. Такие известные разработчикам слова как &quot;сервер&quot;, &quot;защищенный протокол&quot;, &quot;закрытая операция класса&quot;, а также стереотипы и помеченные значения на этом уровне применять не рекомендуется. На уровне спецификации нужно стремиться достичь по возможности полного взаимопонимания между заказчиком и командой разработчиков всех вариантов использования проектируемой системы в контексте их кооперации.
</P>
<P>
При построении диаграмм кооперации уровня примеров терминология должна наиболее точно отражать все аспекты реализации соответствующих объектов и связей. Поскольку диаграмма этого уровня является документацией для разработчиков системы, здесь допустимо использовать весь арсенал стереотипов, ограничений и помеченных значений, который имеется в языке UML. Если типовых обозначений недостаточно, разработчики могут дополнить диаграмму собственными элементами, используя механизм расширений языка UML.
</P>
<P>
Процесс построения диаграммы кооперации уровня примеров должен быть согласован с процессами построения диаграммы классов и диаграммы последовательности. В первом случае, как уже отмечалось, необходимо следить за использованием только тех объектов, для которых определены порождающие их классы. Во втором случае нужно согласовывать последовательности передаваемых сообщений. Речь идет о том, что не допускается различный порядок следования сообщений для моделирования одного и того же взаимодействия на диаграмме кооперации и диаграмме последовательности. Таким образом, диаграмма кооперации, с одной стороны, обеспечивает концептуально согласованный переход от статической модели диаграммы классов к динамическим моделям поведения, представляемым диаграммами последовательности, состояний и деятельности. С другой стороны, диаграмма этого типа предопределяет особенности реализации модели на диаграммах компонентов и развертывания, которые являются предметом рассмотрения в двух последующих главах книги.
</P>
<p><hr>
<table cellpadding=10>
<tr><td><a href=../../../index.htm>Каталог</a></td>
    <td><a href=../../index.htm>Индекс раздела</a></td>
    <td><a href=../index.html>Оглавление</a></td></tr>
</table>
</p>

</BODY>
</HTML>

